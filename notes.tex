%  -*- fill-column: 80; ispell-local-dictionary: "american" -*-

\documentclass[12pt,a4paper]{article}
\usepackage{fontspec}
\usepackage{polyglossia}
\setmainlanguage{english}
\setotherlanguage{french}
\usepackage{csquotes}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{mathtools}
\usepackage[margin=2cm]{geometry}
\usepackage{fullpage}
\usepackage[backend=biber, style=numeric, maxbibnames=99]{biblatex}
%\bibliography{doc.bib}
\usepackage{hyperxmp}
\usepackage[citecolor=blue]{hyperref}
\usepackage{xcolor}
\usepackage{algorithm2e}
% \usepackage{minted}
% \usepackage[type={CC}, modifier={by-sa}, version={4.0}]{doclicense}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric,positioning,graphs,graphs.standard,chains,fit,shapes,calc}
\usepackage{wrapfig}

\title{MPRI Graph Algorithms Lecture Notes}
\author{Antonin Décimo}


\def\R{\mathbb{R}}
\def\Z{\mathbb{Z}}
\def\N{\mathbb{N}}
\newtheorem{theorem}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}

\begin{document}
\maketitle
\tableofcontents

\section{Basic notions of graph theory}

\subsection{Notation and terminology}

\begin{definition}[(Multi)-graph] A (multi)-graph is composed of a vertex set,
  and an edge (multi)-set, which is a \(2\) element subset of the vertex set.
  It is denoted by \(G = (V(G), E(G))\), and can be seen as a binary symmetric
  relation.  A digraph is any binary relation.
\end{definition}

In terms of representation, a graph composed of \(n\) vertices is stored as a
\(n \times n\) adjacency boolean matrix, where:
\[a_{i, j} = \begin{cases}
    0 & \text{if } v_i \not\sim v_j\\
    1 & \text{if } v_i \sim v_j
  \end{cases}\]

\paragraph{Graph parameters} (A short list) Vertices \(|V(G)|, n, v, \dots\),
edges \(|E(G)|, m, e, \dots\), \(\Delta(G)\) the max degree, \(\delta(G)\) the
min degree, \(alpha(G)\) the independence number, \(\omega(G)\) the clique
number, a subgraph, an induced subgraph, the matching number, …

\subsection{The four-colors theorem}
The four-colors theorem was first proposed by Francis Guthrie in October 1852
but proved only years later.  Its statement is simple.  The regions of every
simple map can be properly colored using at most four colors.  However, there
were several formulations over the years:

\begin{enumerate}
\item Every planar graph (with no loop) can be properly vertex colored using at
most four colors.
\item (Reformulation by Peter Guthrie Tait (1880)). Every bridge-less cubic
  planar graph is 3-edge-colorable.
\end{enumerate}

Exercise. Prove using those two formulations that that \(K_{3,3}\) and \(K_5\)
are not planar graphs.  Project: study the best known algorithms to decide if a
given graph is planar.

Let's prove that they are indeed equivalent formulations of the same problem.
\begin{theorem}
  Statements (1) \& (2) are equivalent.
\end{theorem}

The key idea is the following: from a graph, construct its dual graph with a
vertex for each face.  The construction is shown in the
figure~\ref{fig:graphdual}. The \(4\) colors are elements of
\(\Z_2 \times \Z_2\), they are \((0, 0), (0, 1), (1, 0), (1, 1)\).  The \(3\)
colors are the non-zero (corresponds to \enquote{proper}) elements
\((0, 1), (1, 0), (1, 1)\).

\begin{proof}
  We may assume that \(G\) is a planar graph where every face is a triangle
  (triangulation).

  \begin{figure}[h!]
    \centering
    \begin{tikzpicture}
      \node[draw, thick, minimum size=4cm, regular polygon,
        regular polygon sides=5] (polygon) {};
      \foreach \i in {1, ..., 5} \draw (polygon.center) -- (polygon.corner \i);
      \draw (polygon.corner 1) to [bend right=90, looseness=1.8]
        (polygon.corner 3);
      \draw (polygon.corner 3) to [bend right=90, looseness=1.8]
        (polygon.corner 5);
    \end{tikzpicture}
    \begin{tikzpicture}
      \node[draw, thick, minimum size=4cm, regular polygon,
        regular polygon sides=5] (outer) {};
      \node[draw, dashed, minimum size=2cm, regular polygon,
        regular polygon sides=5, rotate = 180] (inner) {};
      \foreach \i in {1, ..., 5} \draw (outer.center) -- (outer.corner \i);
      \draw (outer.corner 1) to [bend right=90, looseness=1.8]
        (outer.corner 3);
      \draw (outer.corner 3) to [bend right=90, looseness=1.8]
        (outer.corner 5);
      \node[above left=0.05cm and 0.3cm of outer.side 1] (a) {};
      \node[below right=0.2cm and 0.2cm of outer.side 4] (b) {};
      \node[above right=of outer.side 5] (c) {};
      \draw [dashed] (a.center) to [bend left=20] (c.center) to [bend left=20]
        (b.center);
      \draw [dashed] (inner.corner 3) to (c);
      \draw [dashed] (inner.corner 1) to [bend right=90, looseness=1.8] (b.center)
        to (inner.corner 2);
      \draw [dashed] (inner.corner 4) to (a.center) to [bend right=90,
        looseness=1.8] (inner.corner 5);
    \end{tikzpicture}
    \caption{Constructing the corresponding bridgeless cubic planar graph}\label{fig:graphdual}
  \end{figure}
\end{proof}

Many theories were developed to prove the four-colors theorem, among them:

\begin{wrapfigure}{r}{0.5\textwidth}
  \begin{center}
  \begin{tikzpicture}[scale=0.5]
    \draw (-1,0) to[bend left] (1,0);
    \draw (-1.2,.1) to[bend right] (1.2,.1);
    \draw[rotate=0] (0,0) ellipse (100pt and 50pt);
  \end{tikzpicture}
  \caption{Embedding on a torus}
  \end{center}
\end{wrapfigure}

\textbf{Planarity}:
\begin{itemize}
\item theory of minors
\item topological minor
\item embedding graphs on surfaces
\item crossing number, genus, …
\end{itemize}
\vspace{0.3cm}

\textbf{Coloring}:
\begin{itemize}
\item chromatic number
\item homomorphism
\item \{circular, fractional, acyclic, …\} chromatic number
\item List coloring
\item independence and clique number
\end{itemize}
\vspace{0.3cm}

\textbf{Edge-coloring}:
\begin{itemize}
\item edge-chromatic number
\item fractional edge-chromatic number
\item Hamiltonicity
\item Matching theory
\end{itemize}
\vspace{0.3cm}

A side result is that a cubic graph has an even number of vertices. The proof
comes from the theory of (nowhere zero) flows.

Exercise. Build a cubic bridgeless graph which is not 3-edge-colorable. Conclude
that this graph is not hamiltonian.

Project. Build an infinite family of planar cubic bridgeless graphs that are not
hamiltonians.

Project. Prove that it is NP-complete to decide if a given cubic bridgeless
graph is 3-edge-colorable.

Project. Prove that every 2-connected graph admits a nowhere zero 6-flow.

\subsection{Proper coloring}

\begin{center}
  \begin{tikzpicture}
    \node[draw, circle, thick] (a) {\textcolor{red}{1}};
    \node[draw, circle, thick, below=of a] (b) {\textcolor{red}{1}};
    \node[draw, circle, thick, right=of a] (c) {\textcolor{green}{2}};
    \node[draw, circle, thick, below=of c] (d) {\textcolor{green}{2}};
    \draw (b) to (c) to (a) to (d);
  \end{tikzpicture}
\end{center}

The chromatic number \(\chi(G)\) is the minimum number of colors used in a
proper vertex coloring of G. Normal colors: \(1, 2, 3, 4, 5, 6, \dots\)

Greedy algorithm for coloring.  Take an uncolored vertex, assign to it the
smallest color not used by any of its already colored neighbors.

Corollary. \(\chi(G) \leq \Delta + 1\)

Exercise. Equality holds for odd-cycles and complete graphs.

\begin{theorem}
  Brooks.  If \(G\) is a graph not isomorphic to an odd-cycle or to a complex
  graph, then \(\chi(G) \leq \Delta\).
\end{theorem}

\begin{proof}
  By Lovasz.

  \begin{enumerate}
  \item We may assume \(\Delta \geq 3\). Towards a proof by induction:
  \item \(G\) has no vertex cut or, more generally, no clique-cut.
  \item \(G\) is \(3\)-vertex-connected.
  \item Consider a vertex \(v\) of degree \(\Delta\) (\(\Delta \geq 3\)) there
    must exist two neighbors \(u, w\) of \(v\) which are not adjacent (why?).
  \item \(G \setminus \{u, v\}\) is connected.
  \item Order vertices such that \(v_i=u, v_2=w, \dots, v_n=v\) and that for
    \(i=3 \dots n-1\), vertex \(v_i\) has a neighbor in
    \(\{v_{i+1}, \dots, v_n\}\).
  \item Apply greedy algorithm on \(v_1, \dots, v_n\).
  \end{enumerate}
\end{proof}

Remark on algorithmic application. It can be checked (easily) if \(G\) is
3-connected, then we can use the proof to find a \(\Delta\)-coloring.

Remark. When we are lucky (which means we have one of the good orderings),
greedy algorithm may produce a coloring using \(\chi(G)\)-colors.

However normally the number of colors used by a greedy coloring is much larger
than \(\chi(G)\).

Bipartite and at least one edge if and only if \(\chi(G)=2\).

\begin{center}
  \begin{tikzpicture}[thick, draw]
    \node[circle] (v1) {1};
    \node[circle, right=of v1] (v2) {2};
    \node[circle, right=of v2] (v3) {3};
    \node[circle, right=of v3] (v4) {4};

    \node[circle, below=of v1] (v5) {2};
    \node[circle, below=of v2] (v6) {1};
    \node[circle, below=of v3] (v7) {3};
    \node[circle, below=of v4] (v8) {4};

    \node[draw, ellipse, fit=(v1) (v4)] {};
    \node[draw, ellipse, fit=(v5) (v8)] {};

    \draw (v1) -- (v5) -- (v3) -- (v6) -- (v2) -- (v7) -- (v1) -- (v8) -- (v2);
    \draw (v6) -- (v4) -- (v7);
    \draw (v4) -- (v5);
    \draw (v3) -- (v8);
  \end{tikzpicture}
\end{center}

Homework. Find ordering of vertices for interval graphs, for chordal graphs, …

Algorithmic discussion.  Simplest algorithm to decide if \(\chi(G) \leq k\) is
to consider all possible \(k-colorings\), that is \(k^n\) possible
coloring. Better bounds are provided. \(O(2^n n)\) for any
\(k\). \(O(1,3289^n)\) for \(k=3\). \(O(1,7272^n)\) for \(k=4\).

Recursive formula \(\chi(G)=\min\{\chi(G+uv), \chi(G-uv)\}\) can be used for an
algorithm of order \(O\left({\left(\frac{1+\sqrt{5}}{2}\right)}^{n+m}\right)\).

(proper) edge-coloring: coloring of edges such that incident edges receive
different colors.

edge-chromatic number: minimum number of colors in an edge-coloring. Denoted
\(\chi'(G)\).

Observation: \(\chi'(G) \geq \Delta\).

\begin{center}
  \begin{tikzpicture}
    \node[minimum size=2cm, regular polygon, regular polygon sides=6]
      (polygon) {};
    \draw[green] (polygon.corner 1) -- (polygon.corner 2);
    \draw[red, dashed] (polygon.corner 2) -- (polygon.corner 3);
    \draw[green] (polygon.corner 3) -- (polygon.corner 4);
    \draw[red, dashed] (polygon.corner 4) -- (polygon.corner 5);
    \draw[green] (polygon.corner 5) -- (polygon.corner 6);
    \draw[red, dashed] (polygon.corner 6) -- (polygon.corner 1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[minimum size=2cm, regular polygon, regular polygon sides=5]
      (polygon) {};
    \draw[green] (polygon.corner 1) -- (polygon.corner 2);
    \draw[red, dashed] (polygon.corner 2) -- (polygon.corner 3);
    \draw[blue, dotted] (polygon.corner 3) -- (polygon.corner 4);
    \draw[green] (polygon.corner 4) -- (polygon.corner 5);
    \draw[red, dashed] (polygon.corner 5) -- (polygon.corner 1);
  \end{tikzpicture}
\end{center}

Exercise:
\(\chi'(C_{2k})=2, \chi'(C_{2k+1})=3, \chi'(K_{2n})=2n-1, \chi'(K_{2n+1})=2n+1\).

Theorem (Vizing) \(\chi'(G) \leq \Delta + 1\)

Key idea: consider a partial coloring and let \(P\) be a maximal 2-edge-colored
path (or an even cycle). If we switch the colors on the edges of \(P\), then we
still have a partial coloring.

\begin{center}
  \begin{tikzpicture}
    \node[draw, circle] (v1) {}; \node[draw, circle, right=of v1] (v2) {};
    \node[draw, circle, right=of v2] (v3) {}; \node[draw, circle, right=of v3]
    (v4) {}; \node[draw, circle, right=of v4] (v5) {}; \node[draw, circle,
    right=of v5] (v6) {};

    \draw[thick,red] (v1) -- (v2); \draw[thick,green] (v2) -- (v3);
    \draw[thick,red] (v3) -- (v4); \draw[thick,green] (v4) -- (v5);
    \draw[thick,red] (v5) -- (v6);

    \node[draw, circle, below=of v1] (u1) {}; \node[draw, circle, right=of u1]
    (u2) {}; \node[draw, circle, right=of u2] (u3) {}; \node[draw, circle,
    right=of u3] (u4) {}; \node[draw, circle, right=of u4] (u5) {}; \node[draw,
    circle, right=of u5] (u6) {}; \node[circle, right=of u6] (u7) {};

    \draw[thick,green] (u1) -- (u2); \draw[thick,red] (u2) -- (u3);
    \draw[thick,green] (u3) -- (u4); \draw[thick,red] (u4) -- (u5);
    \draw[thick,green] (u5) -- (u6); \draw[thick,red] (u6) -- (u7);
  \end{tikzpicture}
\end{center}

\begin{center}
  \begin{tikzpicture}
    \node[thick, minimum size=2cm, regular polygon, regular polygon
      sides=3] (polygon) {};
    \draw[red, thick] (polygon.corner 1) -- (polygon.corner 2);
    \draw[blue, dashed] (polygon.corner 2) -- (polygon.corner 3);
    \draw[green, dotted] (polygon.corner 3) -- (polygon.corner 1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[minimum size=2cm, regular polygon, regular polygon sides=4]
      (polygon) {};
    \foreach \i in {1, ..., 4} \draw[blue, dashed] (polygon.center) --
      (polygon.corner \i);
    \draw[red, thick] (polygon.corner 1) -- (polygon.corner 2);
    \draw[red, thick] (polygon.corner 3) -- (polygon.corner 4);
    \draw[green, dotted] (polygon.corner 2) -- (polygon.corner 3);
    \draw[green, dotted] (polygon.corner 4) -- (polygon.corner 1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[draw, thick, minimum size=2cm, regular polygon, regular polygon
      sides=5] (polygon) {};
    \draw (polygon.corner 5) -- (polygon.corner 3) -- (polygon.corner 1) --
      (polygon.corner 4) -- (polygon.corner 2) -- (polygon.corner 5);
  \end{tikzpicture}

  \begin{tikzpicture}
    \node[draw, thick, minimum size=3cm, regular polygon, regular polygon
      sides=5] (polygon) {};
    \foreach \i in {1, ..., 5} \draw (polygon.center) -- (polygon.corner \i);
    \draw (polygon.corner 5) -- (polygon.corner 3) -- (polygon.corner 1) --
      (polygon.corner 4) -- (polygon.corner 2);
  \end{tikzpicture}
\end{center}

A proof of Vizing theorem (by Ehrenfecht, Fabor, Kierstead).  We aim to prove a
stronger claim by induction.

Assume: \begin{enumerate}
\item \(d(v) \leq k\) (induction on \(k\)),
\item for \(u \sim v, d(u) \leq k\),
\item for at most one \(u \sim v, d(u) = k\),
\item \(G \setminus v\) is \(k\)-edge-colorable,
\end{enumerate} then \(G\) is \(k\)-edge-colorable.

Step 1. By adding pendant vertices, if needed we may assume
\(d(u_1) = k, d(u_2) = d(u_3) =\cdots = k - 1\).

We consider a \(k\)-edge-coloring of \(G \setminus v\) and define
\[\chi_i = {\text{neighbors of } v \text{ which miss color } i}.\]

Among all \(k\)-edge-colorings of \(G\setminus v\) we chose one such that
\(\sum{|x_i|}^2\) is minimized.

\[\sum_{i=1}^k|\chi_i| = 2d(v)-1\]

Claim. For some \(i, 1 \leq i \leq k\) we have \(|\chi_i| = 1\). Otherwise for
some \(i\) we have \(|\chi_i| = 0\) and since \(\sum|\chi_i|\) is an odd number,
for some \(j\) we have \(|\chi_j| \geq 3\). Now consider a maximal
\({i, j}\)-colored path starting with a vertex in \(\chi_j\) (and not in
\(\chi_i\)).  Exchanging the colors \(i\) and \(j\) on this path will/may
increase \(|\chi_i|\) by \(1\) and decrease \(|\chi_j|\) by \(1\), but this
decreases \(\sum{|\chi_i|}^2\), contradiction.

That means a color say \(i\) is missed exactly in one vertex, say \(u\). Remove
from \(G\) the edge \(u v\) and all edges of color \(i\). Let \(G'\) be the
resulting graph. Then \(G'\) and \(v\) satisfy the conditions of our main claim
for \(k-1\).

Corollary. If the set of vertices of degree \(\Delta(G)\) induces an acyclic
graph (a forest), then \(\chi'(G) = \Delta(G)\).

Question: Does this proof translate to a polynomial-time algorithm to find a
\((\Delta + 1)\)-edge-coloring of a give simple graph?

A gadget to build cubic \(2\)-connected graphs that are not
\(3\)-edge-colorable.

\begin{center}
  \begin{tikzpicture}
    \draw (0, 0) -- (1, 0) -- (2, 0) -- (3, 0);
    \draw (1, 0) -- (1, 1) -- (2, 1) -- (2, 0);
    \draw (1, 1) -- (2, 2);
    \draw (2, 1) -- (1, 2);
    \draw (0, 2) -- (1, 2) -- (2, 2) -- (3, 2);
    \draw[dashed, green] (1.5, 1) to[bend right] (1.75, 0.25);
  \end{tikzpicture}
\end{center}

Lemma. In any \(3\)-edge-coloring of this graphs either left parallel edges or
the right ones receive a same color and the other \(3\) pendant edges receive
\(3\) distinct colors. Conversely, any such coloring of the \(5\) pendant edges
can be extended to the whole graph.

\begin{center}
  \begin{tikzpicture}
    \draw (0, 0) -- (0.5, 0.5) -- (1.5, 0.5) -- (2, 0);
    \draw (0, 3) -- (0.5, 2.5) -- (1.5, 2.5) -- (2, 3);
    \draw (0, 1.5) -- (1, 1.5) -- (2, 1.5);
    \draw (0.5, 0.5) -- (0, 1.5) -- (0.5, 2.5);
    \draw (1.5, 0.5) -- (2, 1.5) -- (1.5, 2.5);
    \draw (1, 1.5) -- (1.25, 2.2);
  \end{tikzpicture}
\end{center}

\paragraph{The Petersen graph}
\(3\)-regular, \(3\)-connected, \(\chi' = 4\). (Note~: could not remove vertex
labels.)
\begin{center}
  \begin{tikzpicture}
    \graph [clockwise] {
      subgraph C_n [n=5, name=A, radius=2cm];
      subgraph I_n [n=5, name=B, radius=1cm];
      \foreach \i [evaluate={\j=int(mod(\i+2,5)+1);}] in {1,...,5} {
        A \i -- B \i;
        B \i -- B \j;
      }
    };
  \end{tikzpicture}
\end{center}

\subsection{NP, NP-hard, NP-completeness}

NP (non-deterministic polynomial time), NP-completeness, NP-hard.

A problem is in NP if every solution can be verified in polynomial time.

A problem is NP-hard if every problem in NP can be reduced to it in polynomial
time.

Three different types of reductions are considered.
\begin{itemize}
\item Many-to-one (Karp reduction);
\item Truth-table;
\item Turing reduction (or Cook-reduction). Cook proved in 1971 that \(3\)-SAT
  is NP-hard.
\end{itemize}

NP-complete: an NP-hard problem which is itself in NP.\@

In our study to prove that a problem \(P\) is NP-hard, we show a many-to-one
reduction from a problem already known to be NP-hard to our problem \(P\).

Problem: \(3\)-edge-coloring (sub)-cubic graph (\(3\)-ECCG).
Input: a sub-cubic graph \(G\).
Output: Yes --- if \(G\) is \(3\)-edge-colorable, No if \(G\) is not
\(3\)-edge-colorable.

Note: It is enough to consider cubic instances.

\begin{theorem}
  The problem \(3\)-ECCG is NP-complete.
\end{theorem}

\begin{proof}
  Since a coloring can be verified in \(|E(G)|\) steps, the problem is in NP.\@

  To complete the proof we show a polynomial-time reduction from \(3\)-SAT to
  \(3\)-ECCG.\@ That is given an instance \(L\) of \(3\)-SAT, we build a graph
  \(G_L\) such that:

  \begin{enumerate}
  \item \(G_L\) is sub-cubic;
  \item Order of \(G_L\) is polynomial in size of \(L\) (number of variables and
    clauses of \(L\));
  \item \(L\) is a YES instance of \(3\)-SAT if and only if \(G_L\) is
    \(3\)-edge-colorable.
  \end{enumerate}

  \[L: (x_1 \vee x_2 \vee \bar{x_3}) \wedge (x_1 \vee \bar{x_2} \vee x_5)
    \wedge \cdots\]

  Variable \(x_i\) appears \(k\) times. Suppose variable \(x_i\) appears \(k\)
  times (in a positive or negative form).  Associate to \(x_i\) the following
  \enquote{variable gadgets}.

  Step 1. Form pairs.
  Step 2. Form a cycle using \(k\) pairs.


  Main property of variable gadgets: in every \(3\)-edge-coloring either each
  pairs of pendant edges receive the same color (\(x_i \to \top\)) or none of
  them (\(x_j \to \bot\)).  Moreover, any choice of coloring of pendant edge
  using at most \(3\) colors satisfying this condition can extend to \(3\)-edge
  coloring of the whole graph.

  Variable gadget for \(x_i\) (in \(k\) clauses).
  \(x_i \to \top\): when all pairs are monochromatic.
  \(x_j \to \bot\): when all pairs are \(2\)-colored.

  To complete our proof we must build a clause gadget of the form where a
  \(3\)-edge-coloring is possible if and only if at least one pairs of pendant
  edges is monochromatic. This is the case in:
\end{proof}

Remarks.  Line graph of \(G\): \(L(G)\), vertices: edges of \(G\), edges:
\(e_i \sim e_j\) if and only if they have a common vertex.

Observation.  Except for \(K_3\), \(\omega(L(G)) = \Delta(G)\), where \(\omega\)
is the clique number and \(G\) is a simple graph.

\begin{definition}
  Clique number.  The greatest integer \(r\) such that \(K_r \subseteq G\) is
  the clique number \(\omega(G)\) of \(G\).
\end{definition}

Corollary of Vizing's theorem: for every line graph we have
\(\omega(L(G)) \leq \chi(L(G)) \leq \omega(L(G)) + 1\).

Question. Given a graph \(H\) is there a graph \(G\) such that \(H \cong L(G)\)?

\begin{theorem}
  Beineke theorem.  \(H \cong L(G)\) (where \(G\) is a simple graph) if and only
  if it contains none of the following graphs as induced sub-graphs.
\end{theorem}

\begin{center}
  \begin{tikzpicture}
    \draw (0, 0) -- (1, 1) -- (1, 0);
    \draw (1, 1) -- (2, 0);
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[draw, thick, minimum size=2cm, regular polygon, regular polygon
      sides=4, rotate=45] (polygon) {};
    \foreach \i in {1, ..., 4} \draw (polygon.center) -- (polygon.corner \i);
    \draw (polygon.corner 2) to[bend left=90, looseness=1.8] (polygon.corner 4);
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[draw, thick, minimum size=2cm, regular polygon, regular polygon
      sides=5] (polygon) {};
    \foreach \i in {1, ..., 5} \draw (polygon.center) -- (polygon.corner \i);
  \end{tikzpicture}

  \begin{tikzpicture}
    \draw (1, 0) -- (0, 0.5) -- (1, 1) -- (2, 0.5) -- (1, 0) -- (1, 1);
    \draw (0, 0.5) -- (0, 1.5);
    \draw (2, 0.5) -- (2, 1.5);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (1, 0) -- (0, 0.5) -- (1, 1) -- (2, 0.5) -- (1, 0) -- (1, 1);
    \draw (0, 0.5) -- (0, 1.5) -- (2, 1.5) -- (2, 0.5);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (1, 0) -- (0, 0.5) -- (1, 1) -- (2, 0.5) -- (1, 0) -- (1, 1);
    \draw (0, 0.5) -- (1, 1.5) -- (2, 0.5);
  \end{tikzpicture}

  \begin{tikzpicture}
    \draw (1, 0) -- (0, 0.5) -- (1, 1) -- (0.5, 0.5) -- (1, 0) -- (1, 1);
    \draw (1, 0) -- (1.5, 0.5) -- (2, 0.5);
    \draw (1, 1) -- (1.5, 0.5);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (1, 0) -- (0, 0.5) -- (1, 1) -- (0.5, 0.5) -- (1, 0) -- (1, 1);
    \draw (1, 0) -- (1.5, 0.5) -- (2, 0.5) -- (1, 0);
    \draw (1.5, 0.5) -- (1, 1) -- (2, 0.5);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (0, 0) -- (1, 0) -- (2, 0) -- (2.5, 1) -- (1.5, 1) -- (1, 0) -- (0.5,
    1) -- (0, 0);
    \draw (0.5, 1) -- (1.5, 1) -- (2, 0);
  \end{tikzpicture}
\end{center}

\begin{theorem}
  Strengthening of the Vizing theorem (Keirstead): If \(G\) is a graph with no
  induced \(K_{1,3}\) or \(K_5\), then
  \(\chi(G) \in \left\{\omega(G), \omega(G) + 1\right\}\).  Note that
  \(\omega(G)\) is computable in polynomial time for this class of graphs: each
  \(K_4\) extends in a unique way to a maximal clique.
\end{theorem}

\subsection{Graph homomorphisms}

\begin{definition}
  Homomorphism.  Generally: a mapping from ground set to a ground set which
  preserves main structures.
\end{definition}

Examples:
\begin{itemize}
\item Groups. \(h: (E, +) \to (F, *)\), \(h: E \to F\) such that
  \(h(x + y) = h(x) * h(y)\) for every pair \(x, y \in E\).
\item Graphs. \(h: G \to H\), \(h: V(G) \to V(H)\) such that \(xy \in E(G)
  \Rightarrow h(x)h(y) \in E(H)\).
\end{itemize}

Homework. \(G \to K_k\) (the complete graph on \(k\) vertices) if and only if
\(\chi(G) \leq k\).
\(\chi(G) = \min\left\{|V(H)| \,\middle|\, G \to H\right\}\).

\begin{definition}
  Core of a graph \(G\) is \enquote{the} smallest sub-graph \(H\) such that \(G
  \to H\).

  If \(h: G \to H, f: H \to F\) then \(f \circ h: G \to F\).  We need to show
  that any two minimal images are isomorphic.
\end{definition}

Graphs: binary symmetric relations.
Digraphs: binary relations.
Oriented graphs: binary anti-symmetric relations.
Edge-colored graphs, hyper-graphs.

How to present \(3\)-SAT as a homomorphism problem?  Given an instance of
\(3\)-SAT our task is to assign \(\top, \bot\) to variables such that each
clause receives at least one \(\top\) assignment.

Problem: H-Coloring.
Input: a graph \(G\).
Output: YES if \(G \to H\), NO if \(G \not\to H\)

\begin{theorem}
  Hell \& Nesetril? 1990.  If \(H\) is \(2\)-colorable, then H-Coloring problem
  is polynomial-time solvable.  If \(\chi(H) \geq 3\), then H-Coloring is an
  NP-hard problem.
\end{theorem}

Coloring and homomorphisms of digraphs:
Input: a digraph \(X\).
Output: YES if \(X \to D\), NO if \(x \not\to D\).

Challenging question: for which \(D\) is the problem polynomial-time, and for
which \(D\) is the problem NP-complete?

Conjecture of Feder \& Vardi. Any constraint satisfaction problem is either
polynomial-time solvable or it is an NP-hard problem.

They proved that it is enough to prove the conjecture for \(D\)-Coloring
(problem of existence of homomorphism from digraphs to digraph \(D\)).

Vertex-coloring and chromatic umber: to partition vertices into independent
sets.

Independence number of graph, denoted by \(\alpha(G)\), is the maximum number of
vertices of \(G\) pairwise non-adjacent.

Corollary. \(\chi(G) \geq \frac{|V(G)|}{\alpha(G)}\).

Determining \(\alpha(G)\) is an NP-hard problem.  Best known algorithm so far:
\(O(1.2209^n)\).

Note: \(\alpha(G) = \omega(\bar{G})\).

Thus the \enquote{Independence-number} problem on the class of all graphs is the
same as the \enquote{Clique-number} problem.

\subsection{Chromatic number as an Integer program}

Let \(\mathcal{I}\) be the set of all (maximal) independent sets of \(G\).
\(\varphi: \mathcal{I} \to \{0, 1\}\). \(1\) means that \(I\) is a color class,
\(0\) that \(I\) is not a color class.

Condition: \(\sum_{x \in \mathcal{I}} \varphi(I) \geq 1\) for every vertex \(x
\in V\).  Vertex \(v\) is colored.

Optimization: \(\min_{\varphi} \sum_{I \in \mathcal{I}} \varphi(I)\).  We
minimize the number of color classes.

Linear program.

\subsubsection{Fractional chromatic number \(\chi_f(G)\)}
\(\mathcal{I}\) is the set of all independent sets.
\(\varphi: \mathcal{I} \to [0, 1]\) (all real numbers \(0 \leq x \leq 1\)).

Condition: \[\sum_{x \in I} \varphi(I) \geq 1\]
\[\chi_{\_}(G) = \min_\varphi \sum_{I \in \mathcal{I}} \varphi(I)\]

Corollary. \[\chi_f(G) \leq \chi(G)\]
\[\chi_f(G) \geq \frac{|V(G)|}{\alpha(G)}\]

\subsubsection{Intersection graphs}
Vertices: sets or structures.
Edges: \(S \sim S' \Leftrightarrow S \text{ intersects/not intersects } S'\).

Examples: interval graphs, unit (proper) interval graphs, box graphs,
generalization using trees, …

\subsubsection{Permutation graphs}
\subsubsection{Kreser graph \(K(n, k)\)}
Vertices: \(k\)-subsets of \(\{1, \dots, n\}\).
Edges: \(A \sim B \Leftrightarrow A \cap B = \emptyset\)

\[\chi_f(G) = \inf\left\{ \frac{n}{k} \,\middle|\, G \to K(n, k)\right\}\]

Maximum independent set? Chromatic number? Relation to the fractional chromatic
number.

Project: present a proof of Erdős-Ko-Rado theorem.

\subsubsection{Secondary greedy coloring}
Largest independent set: \(I_1 \to\) color class \(1\).  \(G := G \setminus I_1\).
Largest independent set: \(I_2 \to\) color class \(1\).  \(G := G \setminus I_2\).

This algorithm might be better than the greedy coloring in average, but it may
still produce a coloring with many more colors than one may need.

Observation.  While \(k\)-coloring and \(H\)-coloring problems are NP-hard,
there might be nice algorithms if inputs are restricted by some structural
properties.

Example:
\begin{itemize}
\item \(4\)-coloring planar graphs;
\item \(3\)-coloring triangle-free planar graphs.  Chromatic number of interval
  graphs, \(P_4\)-free graphs, permutation graphs, graphs of bounded tree-width,
  …
\end{itemize}

\subsubsection{Duality of coloring and minor theories}
Graphs with no \(K_3\) minors?

Stronger connection between coloring and minor theory is provided through
extended notion of signed graphs: \((G, \delta)\), where \(\delta\) is an
assignment of \(+\) or \(-\) to the edges of \(G\).

Analogue of independence number for edge-coloring.  A matching is a set of edges
no two of have a common vertex.  \(\nu(G)\) denotes the maximum size of a
matching in \(G\).  A perfect matching is a matching that covers all vertices.

A related parameter: vertex cover.  A set of vertices which intersect every
edge.  \(\tau(G)\) denotes the minimum size of a vertex cover of \(G\).

Observation: \(\tau(G) \geq \nu(G)\).

\begin{theorem}
  For any bipartite graph we have \(\nu(G) = \tau(G)\).
\end{theorem}

\begin{proof}
  Suppose that \(G\) is a bipartite graph with at least one edge (otherwise
  \(\nu = \tau = 0\)).

  Claim: there exists a vertex \(u \in \nu(G)\) which belongs to every maximum
  matching.

  Lets prove the claim.  Let \(uv\) be an edge.  Assume to the contrary that for
  every vertex there exists a maximum matching missing that vertex.  Let \(M_u\)
  be the maximum matching missing \(u\) and \(M_v\) be the maximum matching
  missing \(v\).  Then, \(M_u\) must contain an edge \(e\) incident to \(v\).

  Consider \(M_u \cup M_v\) and the component \(P\) containing vertex \(u\).
  Note that:
  \begin{enumerate}
  \item \(P\) is a path (why not an even cycle?)
  \item \(P\) starts at \(u\) but cannot end at \(v\) (why?)
  \item \(P\) cannot end in blue.
  \end{enumerate}
  In \(M_v\) switch edges of \(P\) and add \(uv\) to get larger matching.

  Now, we'll prove the theorem by induction on \(\nu(G)\).  If \(\nu(G)=0\)
  (i.e. \(G\) has no edges) then \(\tau(G)=0\) and done.  Suppose
  \(\nu(G) = \tau(G)\) whenever \(G\) is bipartite and \(\nu(G) \leq k - 1\).
  Suppose \(G\) is bipartite and \(\nu(G) = k\).  Let \(u\) be a vertex which
  belongs to any maximum matching.  Thus, \(\nu(G\setminus u) = k - 1\).  By
  induction, \(G\setminus u\) has a vertex cover \(C\) of size \(k - 1\).  Then
  \(C \cup \{u\}\) is a vertex cover of size \(k\).  Thus
  \(\tau(G) \leq \nu(G)\) for bipartite graphs.  However \(\tau(G) \geq \nu(G)\)
  holds for all graphs, thus \(\tau(G) = \nu(G)\) for bipartite graphs.
\end{proof}

Corollary: every \(k\)-regular bipartite graph has a perfect matching.
\begin{proof}
  Singe \(G\) is regular, the two parts have a same number of vertices, say
  \(n\) (i.e. \(|\nu(G)|=2n\)).  Thus \(G\) has exactly \(kn\) edges.  Let \(C\)
  be a vertex cover of size \(\tau(G)\).  Each vertex covers exactly \(k\)
  edges, thus \(\tau(G)\) vertices covers at most \(k \tau(G)\) edges.  Thus,
  \(k \tau(G) \geq k n \Rightarrow \tau(G) \geq n \Rightarrow \nu(G) \geq n
  \Rightarrow \nu(G) = n\).
\end{proof}

Corollary: every \(k\)-regular bipartite graph has an edge-chromatic number of
exactly \(k\).

Corollary: for every bipartite graph, \(\chi'(G) = \Delta(G)\).

Other min-max theorems:

\begin{theorem}
  Menger.  Let \(G\) be a (connected) graph.  Let \(u\) and \(v\) be two
  vertices, then the maximum number of internally vertex disjoints paths
  connecting \(u\) to \(v\) is the same as the minimum number of vertices of an
  \(s\)-\(t\)-cut (a cut which separates \(s\) and \(t\)).
\end{theorem}

Note: theorem is still valid if \(s\) and \(t\) are replaced by sets of vertices
\(S\) and \(T\).

\begin{theorem}
  Menger's, directed version.
  \begin{itemize}
  \item \(D\) is a digraph, \(S\) and \(T\) subsets of vertices.
  \item \(S\)-\(T\) path: a directed path which starts at a vertex in \(S\) and
    ends at a vertex of \(T\).
  \item \(S\)-\(T\) cut: a set \(X\) of vertices where every \(S\)-\(T\) path
    must use at least one vertex of \(X\).
  \end{itemize}
\end{theorem}

The claim: maximum number of internally disjoints \(S\)-\(T\) paths is equal to
the minimum number of vertices in a \(S\)-\(T\) cut.

Algorithmic comment.  Given a digraph \(D\) and vertices \(s\) and \(t\), a
minimum \(s\)-\(t\) cut and a maximum number of internally disjoint \(s\)-\(t\)
paths can be found in \(O(n m)\) steps.

Algorithms for finding a maximum matching in a bipartite graph.  A main idea:
\(M\)-augmenting path.  Let \(G\) be a graph, \(M\) a matching.  Question: is
\(M\) a maximum matching?

\(M\)-augmenting path.  Change \(M\) to \(M' \oplus P\) (replace blue edges of
\(P\) with red edges of \(P\)).

Thus, if \(M\) is a maximum matching, then there is no \(M\)-augmenting path.
On the other hand, if \(M'\) is matching with more edges than \(M\), then
\(M' \cup M\) is the union of even cycles and paths, one of which is necessarily
an \(M\)-augmenting path.

Conclusion.  A matching \(M\) of graph \(G\) is a maximum matching if and only
if there is no \(M\)-augmenting path.

Algorithm.  Input: a bipartite graph \(G\) and a matching \(M\).  Output: an
\(M\)-augmenting path \(P\) or certify that there is none.

Remark.  \(Y_M\)-\(X_M\) path can be found in \(O(m)\) time.  Starting with
\(M=\emptyset\), one may reach a maximum size matching in at most \(O(n m)\)
times.

Second algorithm.  Maximum matching.  Corresponds to maximum number of
\(x\)-\(y\) paths.

Remark.  Maximum number of \(x\)-\(y\) paths can be determined in \(O(\sqrt{n}
m)\) times.

Let \(G\) be a bipartite graph on parts \(A\) and \(B\).  Question: is there a
matching \(M\) which covers all vertices of \(A\)?

Obvious necessary condition (Hall condition):
\[\forall S \subseteq A: |N(S)| \geq |S|\]

\begin{theorem}
  Marriage Hall.  If the condition is satisfied, then \(G\) has an
  \(A\)-saturation matching.
\end{theorem}

\begin{proof}
  By induction on the size of \(A\).  If \(|A| = 0\), then nothing to prove.
  Assume XX \(|A| \leq k -1\), then the theorem is true, and consider case
  \(|A| = k\).

  Case 1. Suppose for every \(S \subsetneq A\), we have \(N(S) \geq |S|+1\).
  Take a vertex \(v \in A\) and match it to a neighbor \(u\) of it.  Remove
  \(v\) and \(u\) and apply induction.

  Case 2. For some \(S \subsetneq A\) we have \(|N(S)| = |S|\).  First apply
  induction on sub-graph induced by \(S\) and \(|N(S)\).  Then remove \(S\) and
  \(N(S)\) from \(G\) and apply induction on the resulting graph.

  Strengthening: \(G\) bipartite graph on \(A\) and \(B\).  For
  \(S \subseteq A\) define \(\delta(S) = \max\{0, |S| - |N(S)|\}\).  Define
  \(\mu(G) = \max_{S \subseteq A}\{\delta(S)\}\).  The largest matching of \(G\)
  covers \(|A| - \mu(G)\) vertices of \(A\).

  System of distinct representatives. \[A_1, \dots, A_k \subseteq \mathcal{U}.\]
  There exists distinct vertices \(x_1 \in A_1, \dots, x_k \in A_k\) if and only
  if for every \(S \subseteq [1, k]\) we have
  \[\left| \bigcup_{i \in S} A_i \right| \geq |S|.\]
\end{proof}

Maximum matching in general graph.  Question 1.  Does \(G\) admit a perfect
matching?

\begin{definition}
  \(O(S)\): number of components of \(G \setminus S\) with an odd number of
  vertices.
\end{definition}

Observation.  If \(G\) has a perfect matching, then \(O(S) \leq |S|\) for every
\(S \subseteq \nu(G)\).

\begin{theorem}
  Tutte.  A graph \(G\) admits a perfect matching if and only if
  \(O(S) \leq |S|\) for every \(S \subseteq \nu(G)\).
\end{theorem}

Remark.  Similarly, \(\max\{O(S) - |S|, 0\}\) determines the size of the largest
matching of \(G\).

Project.  Look for algorithms with better running time for regular bipartite
graphs.

\section{Introduction to Minors, TreeWidth and FPT algorithms}
\subsection{Three Algorithmic Problems}
Consider the following problem of connectivity:

\vspace{0.2cm}
\noindent \textbf{Problem}: $k$ disjoint path problem\\
\textbf{Input:} A graph $G$, an integer $k$ and two subsets of vertices $A$ and
$B$ of size $k$\\
\textbf{Output:} TRUE if there exists $k$ vertex disjoint paths from $A$ to $B$?\\
\vspace{0.2cm}

\noindent It's a classic problem that can be solved in time $O(k|E(G)|)$ by a
variant of the Ford-Fulkerson Algorithm.  The maximum value $k$ corresponds to a
minimum vertex cut separating $A$ and $B$ and is a classical result of
\textit{Menger}.

\begin{theorem}[Menger]
  Let $x$ and $y$ be distinct vertices of a graph $G$.  Then the minimum number
  of vertices whose deletion separates $x$ from $y$ is equal to the maximum
  number of internally disjoint paths between $x$ and $y$.
\end{theorem}

\noindent From there we can move on to a smilingly similar problem:

\vspace{0.2cm}
\noindent \textbf{Problem}: $k$ disjoint rooted path problem\\
\textbf{Input:} A graph $G$, an integer $k$ and two subsets of vertices
$X=\{x_1, x_2, \ldots, x_k\}$ and $Y=\{y_1, y_2, \ldots, y_k\}$ of size $k$\\
\textbf{Output:} TRUE if there exists disjoint paths $P_1, P_2, \ldots, P_k$ such
that $P_i$ is a path from $x_i$ to $y_i$?
\vspace{0.2cm}

\noindent This problem is related to commodity flow problem, and has many
applications.  With $k$ being part of the input, this problem is NP-complete,
even when restricted to the class of planar graphs.  Nevertheless, in the Graph
Minor series of papers, \textit{Robertson and Seymour} proved a polynomial
algorithm for fixed $k$.

\begin{theorem}[Robertson-Seymour]
The $k$-disjoint path problem can be solved in time $O(f(k).n^3)$
\end{theorem}

And this result was later improved to quadratic time by \textit{ Kawabayarashi,
  Kobashi and Reed}.

\begin{definition}[Topological minor]
  A graph $H$ is \textbf{topological minor} of a graph $G$ if there exists a
  injective mapping $f$ from $V(H)$ to $V(G)$ such that for each edge $uv$ of
  $H$, there exists in $G$ a path $P_{uv}$ connecting $f(u)$ and $f(v)$ in $G$
  with the property that all these path are internally disjoint.
\end{definition}

%exercise slide 5

\noindent With this definition in mind we can move on to another algorithmic
problem:

\vspace{0.2cm}
\noindent \textbf{Problem}: Topological $H$-minor detection\\
\textbf{Input:} A graph $G$ and a graph $H$\\
\textbf{Output:} TRUE if $H$ is a topological minor of $G$, FALSE otherwise.
\vspace{0.2cm}

\noindent
With $H$ part of the input, the problem is NP-complete.  But with $H$ fixed the
problem is polynomial thanks to the $k$-disjoint path problem algorithm.

\begin{theorem}
  Let $H$ be a fixed graph.  There exists a polynomial time algorithm to decide
  whether $H$ is a topological minor of a given graph $G$.
\end{theorem}

The complexity of the algorithm is in $O(f(k)n^k)$ where $k=|H|$ and $n=|G|$,
therefore polynomial for every fixed $k$. Later, in 2010, \textit{Grohe,
  Kawabarayashi, Marx, and Wollan} proved much better $O(f(k)n^3)$.  Such an
algorithm is called Fixed Parameter Tractable (FPT) algorithm, but we'll come
back to that later on.

In particular, the previous theorem implies that any family of graphs that is
defined with a forbidden FINITE family of graphs as topological minors is
polynomially testable.  Here is an example of such class:

\begin{theorem}[Kuratowski,1930]
  A graph $G$ is planar if and only if it does not contain $K_5$ or $K_{3,3}$ as
  a topological minor.
\end{theorem}

But one does not need Robertson and Seymour Theorem to get poly-time algorithms
for recognizing planar graphs (there exist even linear algorithms to do that).

\subsection{Minors}

Let's agree on the vocabulary first : We define 3 operation on a graph $G$
\begin{enumerate}

\item \textbf{Remove a vertex} $v$ (and all its incident edges), denoted $G \textbackslash v$.
\item \textbf{Remove a edge} $e$ (but not it's end vertices), denoted $G \textbackslash e$.
\item \textbf{Contract an edge} $e=xy$ (ie remove $x$ and $y$ and merge them), denoted $G/e$.
\end{enumerate}
A contraction $G/e$ is \textbf{topological} if one of it's endpoints has degree 2. It's inverse is the \textbf{subdivision operation} which consists in removing an edge $xy$ adding a new vertex $z$ and adding the edges $xz$ and $yz$.

\begin{definition}
Let $G$ and $H$ be two graphs :
\begin{itemize}
\item $H$ is an \textbf{induced subgraph} of $G$ if $H$ is obtained from $G$ by the repeated use of 1.
\item $H$ is a \textbf{subgraph }of $G$ if $H$ is obtain by the repeated use of 1 and 2.
\item $H$ is a \textbf{spanning subgraph} of $G$ if $H$ is obtained from $G$ by the repeated use of 2.
\item $H$ is a \textbf{minor} of $G$ if $H$ obtained from $G$ by the repeated use of rule 1,2 and 3.
\item $H$ is a \textbf{topological minor}  of $G$ if $H$ is a minor of $G$ and every contraction used was topological.
\end{itemize}
\end{definition}

Here is an equivalent but more useful of minors :

\begin{lemma}
Let $G$ and $H$ be two graphs and denote $V(H) = {v_1 , ... , v_p}$. Then $H$ is a minor of $G$ if and only if there exists $p$ connected and disjoint subgraphs $G_1, ... , G_p$ of $G$ such that for every edge $v_iv_j$ of $H$ there exist an edge between $G_i$ and $G_j$
\end{lemma}

%exercices slide 11

Let's get a closer look at topological minors compared to minors : y definiton if $H$ is a topological minor of $G$ $\implies$ $H$ is a minor of $G$ but the converse is not true (exercise). However when $H$ is of small maximum degree, this is nevertheless true.

\begin{theorem}
Let $H$ be a graph with maximum degree at most 3. Then a graph G has an $H$-minor if and only if it contains an $H$-subdivision (topological minor).
\end{theorem}

Proof : Asume $H$ is a minor of $G$. Let $G'$ be another topological minor of $G$ minimal (in the number of edges) such that $H$ is a minor of $G'$. Use the previous lemma, each $G_i$ is a tree with at most 3 leaves and no vertex of degree 2. Each such tree must be a star, so we get the topological minor.

%slide 13

With a similar argument we can prove this more general result:

\begin{theorem}
For every graph $H$, there is a finite family $H$ of graphs with the property that $G$
 contains $H$ as a minor if and only if it contains some graph in $H$ as a topological minor.
\end{theorem}

This result combined with the theorem on topological minor detection now clearly implies the following theorems due to Robertson and Seymour.

\begin{theorem}[Robertson and Seymour,1995]
Let $H$ be a fixed graph. There exists a polynomial time algorithm to decide
whether $H$ is a minor of a given graph $G$.
\end{theorem}

And a corollary:

\begin{theorem}
If $C$ is a class of graphs defined by forbidding finitely many minors, then there
exists a polynomial algorithm to decide whether an input graph belongs to $C$
\end{theorem}

What are the families defined by finitely many forbidden minors ?
\begin{itemize}
\item A trivial fact is that such families are closed under minors (every minor of a graph in the family is in the family).
\item The celebrated Robertson and Seymour Theorem ( > 700 pages of proof (Graph Minors I-II-III .... XXV)) , solving a conjecture of Wagner from 1937
says that this is sufficient.
\end{itemize}

\begin{theorem}[Robertson and Seymour]
Any minor closed class of graph is defined by a finite list of forbidden minors
\end{theorem}

With an important consequence :

\begin{theorem}
If $C$ is a minor closed class, then there exists a polynomial algorithm to decide if an input
graph belongs to $C$.
\end{theorem}

\subsection{Well Quasi Orders}

\begin{definition}[Bounds]
For a given minor closed class $C$, a graph $H$ is said to be a bound if $H$ is not in $C$
but every strict minor of $H$ is.
\end{definition}

\begin{theorem}
Let $C$ be a minor closed class, and $B$ be its (possibly infinite) set of bounds. Then
$G \in C$ if and only if $G$ does not contain any graph of $B$ as a minor.
\end{theorem}

\begin{itemize}
\item So Wagner’s conjecture is to prove that a set of bounds is always finite.
\item Note that by definition the set of bounds forms antichain of the minor partial
order : no bound is a minor of another bound.
\item Is is true that every antichain is finite ?
\end{itemize}

\begin{theorem}
The following are equivalent :
\begin{enumerate}
\item Every minor closed class has a finite set of bounds.
\item There is no infinite antichain for the minor relation.
\end{enumerate}
\end{theorem}

\begin{definition}
A partial order $\curlyeqprec$ defined on a set $X$ is a well quasi order (WQO) if there is no
infinite decreasing sequence and no any infinite antichain.
\end{definition}

Wagner’s conjecture is equivalent to say that the class of all graphs with the minor
relation is a wqo.

\begin{theorem}
Let $( X , \curlyeqprec)$ be a partially ordered set and $( x_i )_{i \in \N}$ be any sequence. Then this
sequence has a infinite subsequence that is either increasing, or decreasing or an antichain.
\end{theorem}

From this we deduce the following which gives equivalent conditions for being a
wqo.

\begin{theorem}
Let $( X , \curlyeqprec)$ be a partially ordered set. The three assertions are equivalent :
\begin{enumerate}
\item $( X , \curlyeqprec)$ is a wqo
\item from every sequence $( x_i )_{i \in \N}$ one can extract an infinite increasing
subsequence.
\item from every sequence $( x_i )_{i \in \N}$ one can extract $i < j$ such that $x_i \curlyeqprec x_j$.
\end{enumerate}
\end{theorem}

This will be useful : in order to prove that a given partial order is a wqo, we will
only prove the third statement, but when we use the fact that an order is a wqo (for
example in a proof by induction), we can use the second statement which is (in
appearance) much stronger.

Let us illustrate this by proving that the set of words on a finite alphabet is wqo for
the subword relation. If $X$ is a set (the alphabet) $X^∗$ denotes the set of finite words
(ordered sequences) over $X$.

\begin{theorem}
Assume $X$ is a finite set. Define a partial order $\curlyeqprec$ on $X^∗$ by $u \curlyeqprec v$ if $u$ is a subword
of $v$ ($u$ can be obtained from $v$ by deletion of letters). Then $( X , \curlyeqprec)$ is a wqo.
\end{theorem}

Higman Theorem replaces the finite alphabet by a WQO one
\begin{theorem}[Higman, 1952]
Let $( X , \curlyeqprec)$ be a wqo. Define a partial order on $X^∗$ by $x_1 x_2 . . . x_k  \curlyeqprec  y_1 y_2 . . . y_l$ if there
exists an increasing injection $f : { 1 , . . . , k } → { 1 , . . . , l }$ such that for every $i$,
$x_i \curlyeqprec  y_{f ( i )}$ . Then $( X , \curlyeqprec)$ is also a wqo.
\end{theorem}

Note that it implies the previous one : if X is finite, it suffices to consider on X the
partial order where no two elements are comparable - it clearly defines a wqo.

A famous result from Kruskal is that finite trees are well quasi ordered for the
topological minor relation. Here we prove a stronger result.

\begin{definition}
Let $( X , \curlyeqprec)$ be a WQO. Let $T$ and $T'$ two rooted trees whose vertices are labelled
by $T$. We say that $T \curlyeqprec T'$ if :
there exists a subdivision $T''$ of $T$ with an isomorphism $\phi$ between $T''$ to a
subgraph of $T'$ such that :
\begin{itemize}
\item $\phi$ preserves the tree order : if $x$ is a ancestor of $y$ in $T$ , then $\phi( x )$ is an
ancestor of $\phi( y )$ in $T'$.
\item $\phi$ preserves the labels : for every vertex $x$ of $T$ , $label( x )  \curlyeqprec label(\phi( x ))$ (we
don’t consider for this the vertices of $T''\ T$ obtained by subdivisions, they
don’t have any label anyway)
\end{itemize}
\end{definition}

(If $| X | = 1$ this is the topological minor relation for rooted trees. Restricted to
paths, this is exactly the partial order defined on words in Higman’s Theorem.)

\begin{theorem}[Kruskal]
The order defined above is a well quasi order on labelled rooted trees.
\end{theorem}


\subsection{TreeWidth}

\begin{definition}
\begin{itemize}
\item Let $G$ be a graph. A tree decomposition of $G$ is a pair $( T , W )$ , where $T$ is a
tree and $W = ( W_t )_{t \in V ( T )}$ a collection of subsets of $V ( G )$ satisfying :
For every $u \in V ( G )$ , $T_u = { t \in V ( T ) , u \in W_t }$ induces a connected subgraph of
$T$ .
For every edge $uv \in E ( G ) , T_u \cap T_v \neq \emptyset$ .
\item The \textbf{width} of a tree decomposition is $max_{t \in V ( T )}(| W_t | − 1 )$.
\item The \textbf{tree width} of a graph $G$, denoted $tw ( G )$ , is the minimum width of a tree
decomposition of $G$.
\end{itemize}
\end{definition}

Equivalently, a tree decomposition of G is a tree T along with a collection of
subtrees $T_v$ , one for each vertex of $G$, with the condition that $T_u$ and $T_v$ intersect if
$uv$ is an edge of $G$. Note that is not a equivalence, it is possible that $T u \cap T v \neq \emptyset$
even if $uv \notin E ( G )$ (this will be the case for chordal graphs).

Here is a key lemma regarding subtree intersection ; by analogy with Helly’s
Theorem on convex subsets of $\R ^ d$ , this property is often called Helly property of
subtrees of a tree.

\begin{lemma}
Let $F$ be a collection of pairwise intersecting subtrees of a given tree $T$ . Then
$\bigcap_{T \in F} T \neq \emptyset$ .
\end{lemma}

\begin{corollary}
$tw( G ) \geq \omega( G ) - 1$  ($\omega( G )$ is the clique number)
\end{corollary}

TreeWidth and Chromatic Number:

\begin{prop}
For every graph $G$, there exists a tree decomposition of width $tw( G )$ such that for
every edge $st \in E ( T )$ , $W_s \not\subset W_t$ and $W_t \not\subset W_s$ . In particular, for every leaf
$f \in V ( T )$ , there exists a vertex $u \in V ( G )$ such that $T_u = \{ f \}$ .
\end{prop}

\begin{theorem}
In every graph $G$, there exists a vertex of degree at most $tw( G )$ .
\end{theorem}

\begin{corollary}
$\chi( G ) ≤ tw( G ) + 1$
\end{corollary}

TreeWidth and Chordal graphs:
\begin{definition}
A graph $G$ is chordal if it has no induced subgraph isomorphic to a cycle of length
at least 4.
\end{definition}

\begin{theorem}
The following statement are equivalent
\begin{enumerate}
\item $G$ is chordal.
\item Every induced subgraph of $G$ contains a simplicial vertex, i.e. a vertex
whose neighbourhood is a clique.
\item $G$ is the intersection graph of a family of subtrees of a tree.
\end{enumerate}
\end{theorem}

Using this characterisation, one gets this equivalent definition of treewidth.

\begin{prop}
$tw( G ) = min{ω( G' ) − 1 , G subgraph of G' and G' is chordal }$.
\end{prop}

TreeWidth and Minors:
\begin{prop}
If $H$ is a minor of $G$, then $tw( H ) ≤ tw( G )$
\end{prop}

\begin{corollary}
The class of graphs of treewidth at most $k$ is closed under taking minors.
\end{corollary}


Bounds for TreeWidth:

Therefore, using the theorem of Robertson and Seymour, we know that it is
defined by a finite number of excluded minors. In fact, this result is not a
consequence of their theorem, but one of its steps, as this result can be proven
directly using the ideas of the proof of Kruskal Theorem.

\begin{theorem}
The class of graphs of treewidth at most $k$ is well quasi order for the minor relation.
\end{theorem}

\begin{corollary}
The class of graphs of treewidth at most $k$ has a finite number of bounds.
\end{corollary}

Small TreeWidth

Let us try to describe the bounds for small values of k .

\begin{theorem}
$tw( G ) \leq 1$ $\Leftrightarrow$ $G$ is a forest $\Leftrightarrow$ $G$ does not contain $K_3$ as a minor\\
$tw( G ) \leq 2$ $\Leftrightarrow$ $G$ does not contain $K_4$ as a minor\\
\end{theorem}

Proof :
\begin{itemize}
\item The proof for $tw( G ) = 2$ shows the role of separators with treewidth.
\item One could hope for a general result $tw( G ) = k$ iff G does not have a $K_{k + 2}$
minor. FALSE
\item There exists graphs with no $K_5$ minor (and as we will see soon, planar graphs)
with arbitrarily high treewidth.
\end{itemize}

There are in fact four bounds for tree width at most 3. $O$ is the octahedron, $W_8$ is
the cycle on 8 vertices where all edges linking diametrically opposite nodes are
added, and $C_5 \times K_2$ is the pentagonal prism (two $C_5$ joined by a perfect matching).

\begin{theorem}
$tw( G ) \leq 3$ $\Leftrightarrow$ $G$ does not contain one of the four following graphs as as a minor :
$K_5$ ,$W 8$ , $O$ and $C_5 \times K_2$.
\end{theorem}

Digression : Hadwiger Conjecture

We have already proven these two sets of inequalities:
$$ \omega( G ) \leq \chi( G ) \leq tw( G ) + 1$$
$$ \omega( G ) \leq \omega_m ( G ) \leq tw( G ) + 1$$
where $\omega_m ( G )$ denotes the largest integer $k$ such that $G$ has a $K_k$ minor.

Conjecture (Hadwiger) : $\chi( G ) \leq \omega_m ( G )$\\
\begin{itemize}
\item It is trivial that $\omega_m ( G ) \leq 2$ $\Leftrightarrow$ $G$ is a forest $\Rightarrow$ $\chi( G ) \leq 2$.
\item We saw $\omega_m ( G ) \leq 3$ $\Leftrightarrow$ $tw( G ) \leq 2$ which implies $\chi( G ) \leq 3$ by the above
inequalities.
\item $\omega_m ( G ) \leq 4$ $\Rightarrow$ $\chi( G ) \leq 4$ contains the Four Colour Theorem since planar
graphs are $K_5$ -minor free. In fact it is equivalent (and hence true), thanks to a
structural characterisation of graphs with no $K_5$ minor due to Wagner.
\end{itemize}


\subsection{Tree Decomposition and Separators}
Separators:

\begin{prop}
Let $( T , W )$ be a tree decomposition of $G$ and $t_1$ $t_2$ be an edge of $T$ and denote by
$S$ the set of vertices $W_{t_1} \cap W_{t_2}$. For $i = 1 , 2$, define $T_i$ as the connected component
of $T \backslash t_1 t_2$ containing $t_i$ , and $G_i$ the subgraph of $G$ induced by $\bigcap_{t \in T_i} ( W_t \backslash S )$ . Then
there are no edges between $G_1$ and $G_2$ .
\end{prop}

Conversely, we have the following result about cutsets that induce complete
graphs.

\begin{prop}
Let $G$ be a graph with a clique cutset $S$ and let $( X_i )_{i \in I}$ be the connected
components of $G \ S$. Define $H_i$ to be the graph induced by $X_i \cap S$. Then
$tw( G ) = max_{i \in I} (tw( H_i ))$.
\end{prop}

Clique Sums:

\begin{definition}
Let $G_1$ and $G_2$ be two graphs and $K_1$ a clique of $G_1$ , $K_2$ a clique of $G_2$ with
$| K_1 | = | K_2 |$ . If $G$ is a graph obtained by identifying vertices of $K_1$ and $K_2$ , and then
removing some edges of this clique, then $G$ is a clique sum of $G_1$ and $G_2$ .
\end{definition}

The previous proposition can be restated in terms of clique sums.

\begin{prop}
If $G$ is a clique sum of $G_1$ and $G_2$ , then $tw( G ) \leq max(tw( G 1 ), tw( G 2 ))$ .
\end{prop}

And another characterization of treewidth

\begin{prop}
$G$ has treewidth at most $k$ if and only if it can be constructed recursively by clique
sum operations starting from graphs on at most $k + 1$ vertices.
\end{prop}

Another Result about separators

This proposition will also be very useful to design algorithms.
\begin{prop}
Let $G$ be a graph of tree width $k$ . Then there exists a subset $X \subset V ( G )$ such that :
\begin{itemize}
\item $X$ is a cutset of $G$
\item $X$ has size at most $k + 1$
\item no connected component of $G \backslash X$ has size larger than $| V ( G )|/ 2$
\end{itemize}
\end{prop}

This also permits to prove that the $2k \times 2k$-grid has treewidth at least $k$ (in fact we
will prove later that its treewidth is $2k$ ).

\begin{corollary}
The treewidth of the grid $G_2k$ , $2k$ is at least $k$.
\end{corollary}

\begin{corollary}
The class of planar graph has unbounded treewidth.
\end{corollary}

%38 => 73 To do

\subsection{Duality --- Cops and Robber}
\subsection{Computing Tree Decomposition's}
\subsection{Treewidth and Planar Graphs}
\subsection{Graphs are WQO}
\subsection{Algorithms for bounded-treewidth graphs}
\subsection{FPT parametrized by size of the solution}


\section{Spectral graph theory}

Find combinatorial properties with linear algebra.\\

$M^*_{i,j} = \bar{M_{j,i}}$.\\

Spectral theorem : $n$ eigenvalues in a graph of size $n$.\\

In a $d$-regular graph, we have the maximum eigenvalue equal to $d$.\\

Spectral theorem: if we have a matrix real and symmetric, the eigen values are
real, and we have $n$ eigenvalues.\\

On a $d$-regular matrix, the laplaciant matrix is $L = D - A$, with $D$ the
diagonal matrix with only $d$, and $A$ the matrix representing the graph.\\

$x^TLx = \sum_{(i,j) \in E} (x_i - x_j)^2$.\\
$R_M(X) = \frac{X^TMX}{X^TX}$.\\
$\lambda_k = \min_{V space, k-dim}\max_{x \in V, x \neq 0}R_M(x)$.\\

$\lambda_k \geq 0$\\
$\lambda_1 = \min_{x \neq 0} R_M(x)$\\
$\lambda_2 = 0$, and $X_2 \neq 1$ if the graph is disconnected.\\

$\lambda_n = 2$ in the normalized laplacian if and only if the graph is
bipartite.\\


edge expansion of $S$ : $\emptyset(S) = \frac{E(S,V-S)}{d|S|}$\\
$\emptyset(G) = \min_{|S| < |V|/2}\emptyset(S)$.\\
We have $\lambda_2/2 \leq \emptyset(G) \leq \sqrt{2 \lambda_2}$.

%\subsection{Second class}

$L = I - \frac{1}{d}A$ is the laplacian, where $A$ is the matrix associated with
the graph.

$x^TLx = \sum_{(u,v) \in E}(X_u - X_v)^2$

$R_M(x) = \frac{x^TMx}{x^Tx}$

$\lambda_1 = \min_{x \neq 0} R_L(x)$. We thus have that $\lambda_1 = 0$ and $X_1
= 1$\\

$\lambda_k = \min_{x \neq 0, X \text{ ind } X_1,...,X_{k-1}}R_L(X)$.
$\lambda_k = 0$ if $G$ has $k$ connected components.\\

$\lambda_n = 2$ in the normalized laplacian if and only if the graph is
bipartite.\\

\subsection{Sparsity}

$\sigma(S) = \frac{2|V|^2 |E(S,V-S)|}{|E||S||V-S|}$

$\sigma(G) = \min_S \sigma(S)$ is the sparsity factor of a graph.

$\emptyset(G) \leq \sigma(S) \leq \emptyset(G)$. So sparsity and expansion are
near each other.\\

\begin{theorem}{}{}
  $\sigma(G) \geq \lambda_2$.
\end{theorem}
\begin{proof}
  We do a relaxation of the problem to prove that.\\
  $\sigma(G) = \min_{\{0,1\}^n} \frac{|V|\sum_{(u,v) \in E}(x_u - x_v)^2}{d
    \sum_{(u,v)}(x_u-x_v)^2}$\\
\end{proof}

$\frac{\lambda_2}{2} \leq \emptyset(G) \leq \sqrt{2 \lambda_2}$

\subsection{Notes}

Luca Trevisan -> Lecture notes -> Expanders (142 pages)


\end{document}
